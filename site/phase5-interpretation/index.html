<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Phase 5, Interpretation - Lurch Deductive Engine Documentation</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="..">Lurch Deductive Engine Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="..">Home</a>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Design Plans <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../design-overview/">Overview</a>
</li>
                            
<li >
    <a href="../phase1-structures/">Phase 1, Structures</a>
</li>
                            
<li >
    <a href="../phase2-input-tree/">Phase 2, The Input Tree</a>
</li>
                            
<li >
    <a href="../phase3-output-tree/">Phase 3, The Output Tree</a>
</li>
                            
<li >
    <a href="../phase4-modification/">Phase 4, Modification</a>
</li>
                            
<li class="active">
    <a href="./">Phase 5, Interpretation</a>
</li>
                            
<li >
    <a href="../phase6-labels/">Phase 6, Labels</a>
</li>
                            
<li >
    <a href="../phase7-validation/">Phase 7, Validation</a>
</li>
                            
<li >
    <a href="../phase8-expressions-and-rules/">Phase 8, Expressions and Rules</a>
</li>
                            
<li >
    <a href="../enhancements/">Enhancements for Later</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">API Documentation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../api-overview/">Overview</a>
</li>
                            
<li >
    <a href="../api-lde/">The LDE</a>
</li>
                            
<li >
    <a href="../api-structures/">Structures</a>
</li>
                            
<li >
    <a href="../api-input-structures/">Input Structures</a>
</li>
                            
<li >
    <a href="../api-output-structures/">Output Structures</a>
</li>
                            
<li >
    <a href="../api-phases/">Phases of processing</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../phase4-modification/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../phase6-labels/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#lde-design-phase-5-interpretation">LDE Design Phase 5: Interpretation</a></li>
            <li><a href="#content">Content</a></li>
            <li><a href="#goal">Goal</a></li>
            <li><a href="#status">Status</a></li>
            <li><a href="#more-robust-unit-tests-for-interpretation">More robust unit tests for interpretation</a></li>
            <li><a href="#efficiency-improvements">Efficiency improvements</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>We have designed the work on the Lurch Deductive Engine (LDE) to progress in
phases.  The idea is that each phase ends with a completed whole that can be
tested in that state, and that provides more features than the previous
state did.  By the time the final phase is complete, the LDE will be a
robust and useful product.</p>
<h1 id="lde-design-phase-5-interpretation">LDE Design Phase 5: Interpretation</h1>
<h2 id="content">Content</h2>
<p>In this phase, we implement the Interpretation Phase of the LDE.</p>
<h2 id="goal">Goal</h2>
<p>The LDE will be able to interpret the Input Tree, creating an Output Tree
from it.</p>
<h2 id="status">Status</h2>
<p>All essential work on this phase is complete.  What remains are a more
robust set of tests for interpretation and some optional efficiency
improvements, both of which are documented below.</p>
<h2 id="more-robust-unit-tests-for-interpretation">More robust unit tests for interpretation</h2>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Add to the <code>InputExpression</code> test file more unit tests that create
   and register dummy subclasses of <code>InputStructure</code> that have additional
   custom <code>interpret</code> routines (besides those types already tested).  Verify
   that those routines get called and do exactly what's expected in the
   creation of their portion of the Output Tree.  Ensure you test a variety
   of different kinds of <code>interpret</code> routines, including ones that copy or
   create attributes, delete children, don't include the default wrapper,
   etc.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add documentation in that test file describing the changes just made.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Once the unit tests pass, build everything and commit.</li>
</ul>
<h2 id="efficiency-improvements">Efficiency improvements</h2>
<p>These optional efficiency improvements were not implemented at first because
it is not clear that they are necessary, and it would be a waste of
development time for no clear benefit.  But if later performance bottlenecks
arise that could be solved by any of the ideas expressed below, the plans
are written here for execution.</p>
<h3 id="caching-interpretation-results">Caching interpretation results</h3>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Extend the <code>InputStructure</code> class with a field called
   <code>lastInterpretation</code>, which is initialized to undefined in the
   constructor.  This field does not need to be part of any serialization
   or deserialization of instances.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Create an <code>getLastInterpretation()</code> method that returns the value of
   that member variable.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Create a <code>saveInterpretation(I)</code> method in the <code>InputStructure</code> class
   that stores the array <code>I</code> (of zero or more Output Structures) in the
   <code>lastInterpretation</code> field.  If no parameter is passed, clear the cached
   value.</li>
<li class="task-list-item"><input type="checkbox" disabled/> At the end of the <code>recursiveInterpret()</code> routine, just before
   returning the result, call <code>saveInterpretation()</code> on it.</li>
<li class="task-list-item"><input type="checkbox" disabled/> At the start of the <code>recursiveInterpret()</code> routine, if the structure
   is not marked dirty and there is a <code>lastInterpretation</code> defined, just
   return that immediately.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Update all documentation in that file to reflect the changes just
   made.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add to the unit tests for <code>InputStructure</code>s a few simple tests for
   these new routines.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add documentation in that file describing the changes just made.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Once the unit tests pass, build everything and commit.</li>
</ul>
<h3 id="miscellaneous">Miscellaneous</h3>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Create a <code>setChildrenList(newChildren)</code> function in the <code>Structure</code>
   base class.  It should change as little as possible (maybe nothing) to
   make the structure's children array equal to the given one.  This lets
   <code>interpret()</code> routines reuse old Output Structures from cache, just
   adjusting their children lists, rather than constructing new ones, even
   if their children list changed.  Many <code>interpret()</code> routines may
   therefore be simply <code>lastInterpretation.setChildrenList(childResults)</code>
   followed by returning the last interpretation again.  This will often
   just verify that the children list is already correct, change nothing,
   and move on.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add to the unit tests for this new routine.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add documentation in the <code>Structure</code> module describing the new
   routine.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Once the unit tests pass, build everything and commit.</li>
</ul>
<h3 id="recursive-interpretation">Recursive interpretation</h3>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Create a subclass of <code>OutputStructure</code>, in the <code>OutputStructure</code>
   module, called <code>InterpretationDirective</code>.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add documentation explaining what it is and will do (though that
   documentation can grow with time).</li>
<li class="task-list-item"><input type="checkbox" disabled/> Ensure that the <code>InterpretationDirective</code> subclass registers itself
   with the serialization code, as
   <a href="https://github.com/lurchmath/lde/blob/master/src/structure.litcoffee#registering-class-names">the documentation here</a>
   describes.  (That is, use a line like
   <code>className : Structure.addSubclass 'InterpretationDirective', InterpretationDirective</code> in
   the <code>InterpretationDirective</code> class code.)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Create a new unit test file for <code>InterpretationDirective</code>s that is
   extremely basic, just testing to be sure that the symbol
   <code>InterpretationDirective</code> is defined at the global scope and creates
   things that are instances of the <code>InterpretationDirective</code> class.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add documentation for that unit test file, following the pattern
   established in the documentation of other unit test files in this
   repository.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Create a subclass <code>FilterableArray</code> of <code>Array</code> that, at construction
   time, is given a predicate.  It stores, internally, a filtered version of
   itself, which is initialized to the empty array.  It guarantees to keep
   this filtered version correct iff it is manipulated only through calls to
   its <code>push()</code> and <code>pop()</code> routines, which we override below.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Override <code>FilterableArray::push()</code> to do an ordinary <code>Array::push()</code>
   and then also a push on the internal filtered version iff the predicate
   holds of the new item.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Override <code>FilterableArray::pop()</code> to do an ordinary <code>Array::pop()</code>
   and then also a pop on the internal filtered version iff the object
   popped was also on the end of that array.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add a new method <code>FilterableArray::filtered()</code> that returns the
   filtered version.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Update the default version of <code>recursiveInterpret()</code> to create the
   <code>accessibles</code> array as an instance of <code>FilterableArray</code>, with the
   predicate being whether the Structure is an instance of the
   <code>InterpretationDirective</code> class.  Ensure that adding items to the array
   and removing them from it are done with calls to <code>push()</code> and <code>pop()</code>.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Document this so that later implementations of <code>interpret()</code> can be
   faster by leveraging <code>accessibles.filtered()</code> rather than the entire
   <code>accessibles</code> array.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Ensure all the unit tests still pass.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add new unit tests for the <code>FilterableArray</code> class independently of
   the rest of the LDE.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add some new unit tests that verify that <code>accessibles.filtered()</code> is
   exactly what it should be (i.e., the Interpretation Directive predicate
   is being used correctly).</li>
<li class="task-list-item"><input type="checkbox" disabled/> Once the unit tests pass, build everything and commit.</li>
</ul></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script src="../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="../search/require.js"></script>
        <script src="../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
