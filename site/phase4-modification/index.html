<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Phase 4, Modification - Lurch Deductive Engine Documentation</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="..">Lurch Deductive Engine Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="..">Home</a>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Design Plans <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../design-overview/">Overview</a>
</li>
                            
<li >
    <a href="../phase1-structures/">Phase 1, Structures</a>
</li>
                            
<li >
    <a href="../phase2-input-tree/">Phase 2, The Input Tree</a>
</li>
                            
<li >
    <a href="../phase3-output-tree/">Phase 3, The Output Tree</a>
</li>
                            
<li class="active">
    <a href="./">Phase 4, Modification</a>
</li>
                            
<li >
    <a href="../phase5-interpretation/">Phase 5, Interpretation</a>
</li>
                            
<li >
    <a href="../phase6-labels/">Phase 6, Labels</a>
</li>
                            
<li >
    <a href="../phase7-validation/">Phase 7, Validation</a>
</li>
                            
<li >
    <a href="../phase8-expressions-and-rules/">Phase 8, Expressions and Rules</a>
</li>
                            
<li >
    <a href="../enhancements/">Enhancements for Later</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">API Documentation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../api-overview/">Overview</a>
</li>
                            
<li >
    <a href="../api-lde/">The LDE</a>
</li>
                            
<li >
    <a href="../api-structures/">Structures</a>
</li>
                            
<li >
    <a href="../api-input-structures/">Input Structures</a>
</li>
                            
<li >
    <a href="../api-output-structures/">Output Structures</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../phase3-output-tree/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../phase5-interpretation/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#lde-design-phase-4-expressions-and-modifiers">LDE Design Phase 4: Expressions and Modifiers</a></li>
            <li><a href="#content">Content</a></li>
            <li><a href="#goal">Goal</a></li>
            <li><a href="#status">Status</a></li>
            <li><a href="#inputexpression-class">InputExpression class</a></li>
            <li><a href="#convenience-functions">Convenience functions</a></li>
            <li><a href="#inputmodifier-class">InputModifier class</a></li>
            <li><a href="#basicinputmodifier-class">BasicInputModifier class</a></li>
            <li><a href="#extending-inputexpression">Extending InputExpression</a></li>
            <li><a href="#the-modification-phase">The Modification Phase</a></li>
            <li><a href="#api-documentation">API Documentation</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>We have designed the work on the Lurch Deductive Engine (LDE) to progress in
phases.  The idea is that each phase ends with a completed whole that can be
tested in that state, and that provides more features than the previous
state did.  By the time the final phase is complete, the LDE will be a
robust and useful product.</p>
<h1 id="lde-design-phase-4-expressions-and-modifiers">LDE Design Phase 4: Expressions and Modifiers</h1>
<h2 id="content">Content</h2>
<p>In this phase, we specialize the <code>InputStructure</code> class into two subclasses,
<code>InputExpression</code> and <code>InputModifier</code>.</p>
<h2 id="goal">Goal</h2>
<p>The <code>InputExpression</code> and <code>InputModifier</code> classes will exist with all their
methods and the Modification phase will be implemented.</p>
<h2 id="status">Status</h2>
<p>This has not been implemented.  See the tasks below.</p>
<h2 id="inputexpression-class"><code>InputExpression</code> class</h2>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled checked/> Create a subclass of <code>InputStructure</code>, in the <code>InputStructure</code>
   module, called <code>InputExpression</code>.</li>
<li class="task-list-item"><input type="checkbox" disabled checked/> Add documentation explaining what it is and will do (though that
   documentation can grow with time).</li>
<li class="task-list-item"><input type="checkbox" disabled checked/> Ensure that the <code>InputExpression</code> subclass registers itself with the
   serialization code, as
   <a href="https://github.com/lurchmath/lde/blob/master/src/structure.litcoffee#registering-class-names">the documentation here</a>
   describes.  (That is, use a line like
   <code>className : Structure.addSubclass 'InputExpression', InputExpression</code> in
   the <code>InputExpression</code> class code.)</li>
<li class="task-list-item"><input type="checkbox" disabled checked/> Create a new unit test file for <code>InputExpression</code>s that is extremely
   basic, just testing to be sure that the symbol <code>InputExpression</code> is
   defined at the global scope and creates things that are instances of the
   <code>InputStructure</code> class.</li>
<li class="task-list-item"><input type="checkbox" disabled checked/> Add documentation for that unit test file, following the pattern
   established in the documentation of other unit test files in this
   repository.</li>
<li class="task-list-item"><input type="checkbox" disabled checked/> Once the unit tests pass, build everything and commit.</li>
</ul>
<h2 id="convenience-functions">Convenience functions</h2>
<p>All of the following functions should be added as members in the
<code>InputExpression</code> class.</p>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> A function for marking an attribute of the expression as having been
   changed by an <code>InputModifier</code> (a class that we will define later, as
   described below).  If the function is called on attribute key <code>k</code>, it
   could, for example, just call <code>X.setAttribute( "IM changed "+k, true )</code>.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Extend the new unit test file for <code>InputExpression</code>s to test this
   new routine and document such tests.</li>
<li class="task-list-item"><input type="checkbox" disabled/> A function for creating a backup copy of all attributes set by
   modifiers, which loops through all attribute keys, and when it encounters
   any of the form "IM changed $k$", it lifts out the value associated with
   $k$ and stores a copy of it in the backup being generated.  That backup
   object is returned.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Extend the new unit test file for <code>InputExpression</code>s to test this
   new routine and document such tests.</li>
<li class="task-list-item"><input type="checkbox" disabled/> A function for comparing the state of an <code>InputExpression</code> to such a
   backup, either reporting that its set of attributes changed by modifiers
   matches the backup (nothing has changed) or it does not (something was
   added, removed, or changed by an IM).</li>
<li class="task-list-item"><input type="checkbox" disabled/> A function for deleting all attributes set by modifiers (which not
   only deletes a pair $(k,v)$, but also the corresponding attribute with
   key "IM changed $k$").</li>
<li class="task-list-item"><input type="checkbox" disabled/> Extend the new unit test file for <code>InputExpression</code>s to test this
   new routine and document such tests.</li>
<li class="task-list-item"><input type="checkbox" disabled/> A function <code>setSingleValue(k,v)</code> that first checks whether the
   expression has an attribute with key $k$.  If so, it returns false and
   takes no further action.  If it doesn't have such an attribute, this one
   adds it and marks it as having been changed by a modifier.  Thus this
   function is intended only to be called by IMs.  In such a case, it
   returns true.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Extend the new unit test file for <code>InputExpression</code>s to test this
   new routine and document such tests.</li>
<li class="task-list-item"><input type="checkbox" disabled/> A function <code>addListItem(k,i)</code> that first checks whether the
   expression has an attribute with key $k$ and value an array.  If not,
   it sets the value to <code>[ i ]</code>, an array containing the item <code>i</code>.  If it
   already had an array value, we append <code>i</code> to it.  In either case, we mark
   this as having been changed by a modifier.  Thus this function is
   intended only to be called by IMs.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Extend the new unit test file for <code>InputExpression</code>s to test this
   new routine and document such tests.</li>
<li class="task-list-item"><input type="checkbox" disabled/> A function <code>addSetElement(k,e)</code> that first checks whether the
   expression has an attribute with key $k$ and value an array.  If not,
   it sets the value to <code>[ e ]</code>, a set containing the element <code>e</code>.  If it
   already had an array value, we append <code>e</code> to it iff it was not already in
   the array.  In any of these cases (even the one where nothing changed),
   we mark this as having been changed by a modifier.  Thus this function is
   intended only to be called by IMs.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Extend the new unit test file for <code>InputExpression</code>s to test this
   new routine and document such tests.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Once the unit tests pass, build everything and commit.</li>
</ul>
<h2 id="inputmodifier-class"><code>InputModifier</code> class</h2>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Create a subclass of <code>InputStructure</code>, in the <code>InputStructure</code>
   module, called <code>InputModifier</code>.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add documentation explaining what it is and will do (though that
   documentation can grow with time).</li>
<li class="task-list-item"><input type="checkbox" disabled/> Ensure that the <code>InputModifier</code> subclass registers itself with the
   serialization code, as
   <a href="https://github.com/lurchmath/lde/blob/master/src/structure.litcoffee#registering-class-names">the documentation here</a>
   describes.  (That is, use a line like
   <code>className : Structure.addSubclass 'InputModifier', InputModifier</code> in
   the <code>InputModifier</code> class code.)</li>
<li class="task-list-item"><input type="checkbox" disabled/> The class should provide two functions that, in the base class, do
   nothing, but will be overridden by subclasses to do something smarter.
   These are <code>updateConnections()</code> and <code>updateDataIn(target)</code>.  Add these
   stubs now.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Document the two functions you just added regarding their purposes
   in subclasses.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Create a new unit test file for <code>InputModifier</code>s that is extremely
   basic, just testing to be sure that the symbol <code>InputModifier</code> is
   defined at the global scope and creates things that are instances of the
   <code>InputStructure</code> class.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add documentation for that unit test file, following the pattern
   established in the documentation of other unit test files in this
   repository.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Once the unit tests pass, build everything and commit.</li>
</ul>
<h2 id="basicinputmodifier-class"><code>BasicInputModifier</code> class</h2>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Create a subclass of <code>InputModifier</code>, in the <code>InputStructure</code>
   module, called <code>BasicInputModifier</code>.  It takes a set of key-value-type
   triples at construction time and stores them for later embedding in a
   target.  The "type" of the triple will be which kind of function should
   be used to insert it (single value, list item, set element).</li>
<li class="task-list-item"><input type="checkbox" disabled/> Override the <code>updateDataIn(target)</code> function to embed exactly those
   key-value pairs in the target.  Take care to ensure that copies of values
   are used rather than the original objects.  Be sure to use the
   appropriate functions that will mark the attribute as having been set by
   an <code>InputModifier</code>.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add documentation explaining what it is and does.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Ensure that the <code>BasicInputModifier</code> subclass registers itself with the
   serialization code, as
   <a href="https://github.com/lurchmath/lde/blob/master/src/structure.litcoffee#registering-class-names">the documentation here</a>
   describes.  (That is, use a line like
   <code>className : Structure.addSubclass 'BasicInputModifier', BasicInputModifier</code>
   in the <code>BasicInputModifier</code> class code.)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Create a new unit test file for <code>BasicInputModifier</code>s that not only
   ensures that the symbol <code>BasicInputModifier</code> is defined at the global
   scope and that its instances are also instances of the <code>InputStructure</code>
   class, but also that the <code>updateDataIn(target)</code> function behaves as
   intended.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add documentation for that unit test file, following the pattern
   established in the documentation of other unit test files in this
   repository.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Once the unit tests pass, build everything and commit.</li>
</ul>
<h2 id="extending-inputexpression">Extending <code>InputExpression</code></h2>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Implement <code>InputExpression</code>'s <code>updateData()</code> function to loop through
   all <code>InputModifiers</code> that connect to it as the target and call their
   <code>updateDataIn()</code> routines on itself.  Be sure to begin by using the
   function that clears out all attributes set by a modifier.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Create unit tests for this, probably located in the <code>InputExpression</code>
   unit test file.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Increase efficiency by calling the backup routine in the target
   first, and at the end marks itself dirty if and only if its new state is
   different from its original state in some attribute set by a modifier.
   (Note that this task, since it is just an increase in efficiency, can be
   deferred until later in the project, and can even be considered optional
   if we notice no performance problems without implementing it.)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Extend the unit tests to handle this new feature.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Once the unit tests pass, build everything and commit.</li>
</ul>
<h2 id="the-modification-phase">The Modification Phase</h2>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Implement a <code>runModification()</code> method in the LDE module.  It should
   run the <code>updateConnections()</code> function in every IM in the Input Tree, in
   an unspecified order, and then call a callback.  (This function is
   asynchronous.)</li>
</ul>
<p>The remainder of this section is efficiency improvements.  Consequently,
they can be deferred until later in the project, and can even be considered
optional if we notice no performance problems without implementing them.  If
you wish to skip them for now, simply jump to the last few tasks in this
section, about unit tests and documentation.</p>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Extend the unit tests of the LDE to test this new function.  This
   will require creating some dummy subclasses of <code>InputModifier</code> that
   implement <code>updateConnections()</code> in various ways.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Enhance <code>runModification()</code> to initialize a list of <code>InputModifier</code>
   instances that are to be processed, then start a chain of <code>setTimeout()</code>
   calls that pop things off the list and process them, calling the callback
   when the list is empty.  (Use extremely brief timeout delays.)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Ensure that the unit tests still handle this asynchronous version.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Enhance <code>runModification()</code> so that, if any LDE API call is made
   while the modification phase is ongoing, it resets the list of instances
   to process to be the entire set of <code>InputModifier</code>s in the Input Tree,
   thus restarting the whole modification process.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Extend the unit tests to test this feature.  That is, make some
   <code>updateConnections()</code> routines that take a long time to compute (say, 0.5
   seconds) and that also log their calls to a global array.  Make a set of
   API calls in succession about 0.3 seconds apart, and ensure that the
   global call log is as expected.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Extend each of the four LDE API functions so that it calls
   <code>markDirty()</code> on the appropriate <code>InputStructure</code> instance, then
   <code>runModification()</code>.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Update the documentation to describe the changes just made.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Extend the unit tests for the LDE module to verify that this works.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Once the unit tests pass, build everything and commit.</li>
</ul>
<h2 id="api-documentation">API Documentation</h2>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Extend the <code>InputStructure</code> page of the API Documentation to include
   all the work done in this phase.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Add a page to the API Documentation for the phases of processing the
   Input and Output Trees.  Begin it by documenting the modification phase,
   and say that more content is to come later.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Update <code>mkdocs.yml</code> in the project root to include that new file in
   the generated documentation.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Rebuild docs and commit.</li>
</ul></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script src="../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="../search/require.js"></script>
        <script src="../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
