var Structure,bind=function(t,e){return function(){return t.apply(e,arguments)}},slice=[].slice,indexOf=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},hasProp={}.hasOwnProperty;exports.Structure=Structure=function(){function t(){var e,n,i,r,s,o;for(i=1<=arguments.length?slice.call(arguments,0):[],this.fillOutConnections=bind(this.fillOutConnections,this),this.clearExternalAttributes=bind(this.clearExternalAttributes,this),this.setExternalAttribute=bind(this.setExternalAttribute,this),this.getExternalAttribute=bind(this.getExternalAttribute,this),this.compute=bind(this.compute,this),this.clearComputedAttributes=bind(this.clearComputedAttributes,this),this.setComputedAttribute=bind(this.setComputedAttribute,this),this.getComputedAttribute=bind(this.getComputedAttribute,this),this.replaceWith=bind(this.replaceWith,this),this.removeChild=bind(this.removeChild,this),this.removeFromParent=bind(this.removeFromParent,this),this.indexInParent=bind(this.indexInParent,this),this.children=bind(this.children,this),this.parent=bind(this.parent,this),this.releaseID=bind(this.releaseID,this),this.getID=bind(this.getID,this),this.computedAttributes={},this.externalAttributes={},this.parentNode=null,this.childList=function(){var n,r,s;for(s=[],n=0,r=i.length;n<r;n++)(e=i[n])instanceof t&&s.push(e);return s}(),r=0,s=(o=this.childList).length;r<s;r++)(n=o[r]).removeFromParent(),n.parentNode=this,"function"==typeof n.wasInserted&&n.wasInserted()}return t.prototype.IDs=[],t.instanceWithID=function(e){return t.prototype.IDs[e]},t.nextUnusedID=function(){var e;return(e=t.prototype.IDs.indexOf(null))>=0?e:t.prototype.IDs.length},t.prototype.getID=function(){if(null==this.ID)return this.ID=t.nextUnusedID(),t.prototype.IDs[this.ID]=this},t.prototype.releaseID=function(){var e;if(null!=this.ID){for(t.prototype.IDs[this.ID]=null,delete this.ID,e=[];null===t.prototype.IDs[t.prototype.IDs.length-1];)e.push(t.prototype.IDs.pop());return e}},t.prototype.parent=function(){return this.parentNode},t.prototype.children=function(){return this.childList.slice(0)},t.prototype.indexInParent=function(){var t,e;return null!=(t=this.parentNode)&&null!=(e=t.childList)?e.indexOf(this):void 0},t.prototype.removeFromParent=function(){var t,e;if(null!=(e=this.parentNode))return t=this.indexInParent(),this.parentNode.childList.splice(t,1),this.parentNode=null,"function"==typeof this.wasRemoved?this.wasRemoved(e,t):void 0},t.prototype.removeChild=function(t){var e;return null!=(e=this.childList[t])?e.removeFromParent():void 0},t.prototype.insertChild=function(e,n){if(null==n&&(n=0),e instanceof t&&0<=n&&n<=this.childList.length)return e.removeFromParent(),this.childList=slice.call(this.childList.slice(0,n)).concat([e],slice.call(this.childList.slice(n))),e.parentNode=this,"function"==typeof e.wasInserted?e.wasInserted():void 0},t.prototype.replaceWith=function(t){var e,n;if(null!=(n=this.parentNode))return e=this.indexInParent(),this.removeFromParent(),n.insertChild(t,e)},t.prototype.isEarlierThan=function(e){var n,i,r,s,o,l,u,h;if(e instanceof t){if(e===this)return!1;for(n=[e];null!=(s=n[0].parent());)n.unshift(s);for(h=this,u=null;null!=h&&indexOf.call(n,h)<0;)u=h,h=h.parent();if(null!=h)return h===this||h!==e&&(i=n.indexOf(h),l=n[i+1],r=u.indexInParent(),o=l.indexInParent(),r<o)}},t.prototype.getComputedAttribute=function(t){return this.computedAttributes[t]},t.prototype.setComputedAttribute=function(t,e){if(this.computedAttributes[t]!==e)return this.computedAttributes[t]=e,"function"==typeof this.wasChanged?this.wasChanged():void 0},t.prototype.clearComputedAttributes=function(){var t,e,n,i,r;for(0===(n=1<=arguments.length?slice.call(arguments,0):[]).length&&(n=Object.keys(this.computedAttributes)),r=[],t=0,i=n.length;t<i;t++)(e=n[t])in this.computedAttributes?(delete this.computedAttributes[e],r.push("function"==typeof this.wasChanged?this.wasChanged():void 0)):r.push(void 0);return r},t.prototype.compute=function(){var t,e,n,i,r,s,o;for(o=[],i=0,r=(e=1<=arguments.length?slice.call(arguments,0):[]).length;i<r;i++)(t=e[i])instanceof Array||(t=[t]),n=t[0],s=2<=t.length?slice.call(t,1):[],o.push(this.setComputedAttribute(n,this[n].apply(this,s)));return o},t.prototype.getExternalAttribute=function(t){return this.externalAttributes[t]},t.prototype.setExternalAttribute=function(t,e){if(this.externalAttributes[t]!==e)return this.externalAttributes[t]=e,"function"==typeof this.wasChanged?this.wasChanged():void 0},t.prototype.clearExternalAttributes=function(){var t,e,n,i,r;for(0===(n=1<=arguments.length?slice.call(arguments,0):[]).length&&(n=Object.keys(this.externalAttributes)),r=[],t=0,i=n.length;t<i;t++)(e=n[t])in this.externalAttributes?(delete this.externalAttributes[e],r.push("function"==typeof this.wasChanged?this.wasChanged():void 0)):r.push(void 0);return r},t.prototype.fillOutConnections=function(){var e,n,i,r,s,o,l,u,h,c,a,p,f,d,b,I,g,x,A,y,v,D,m,C,E;for(o=0,l=(f=this.childList).length;o<l;o++)f[o].fillOutConnections();if(null!=this.ID){a=function(t){var e,n,i,r,s,o;r=[];for(s in t)if(hasProp.call(t,s)){n=t[s];for(o in n)if(hasProp.call(n,o))for(e=1,i=n[o];1<=i?e<=i:e>=i;1<=i?++e:--e)r.push([Number(s),o])}return r},p=(i=function(t){var e,n,i,r,s,o,l;for(s={},i=0,r=t.length;i<r;i++)o=(n=t[i])[0],l=n[1],null==s[o]&&(s[o]={}),null==(e=s[o])[l]&&(e[l]=0),s[o][l]++;return s})(null!=(d=this.getExternalAttribute("connectionsOut"))?d:[]);for(m in p)if(hasProp.call(p,m)&&(u=p[m],null!=(n=t.instanceWithID(m)))){null==(C=i(null!=(b=n.getExternalAttribute("connectionsIn"))?b:[]))[h=this.ID]&&(C[h]={});for(E in u)hasProp.call(u,E)&&(r=u[E],u[E]=C[this.ID][E]=Math.max(r,null!=(I=C[this.ID][E])?I:0));n.setExternalAttribute("connectionsIn",a(C))}s=i(null!=(g=this.getExternalAttribute("connectionsIn"))?g:[]),y=[];for(v in s)if(hasProp.call(s,v)&&(u=s[v],null!=(e=t.instanceWithID(v)))){null==(D=i(null!=(x=e.getExternalAttribute("connectionsOut"))?x:[]))[c=this.ID]&&(D[c]={});for(E in u)hasProp.call(u,E)&&(r=u[E],u[E]=D[this.ID][E]=Math.max(r,null!=(A=D[this.ID][E])?A:0));y.push(e.setExternalAttribute("connectionsOut",a(D)))}return y}},t.prototype.connectTo=function(e,n){var i,r,s,o;return null!=this.ID&&e instanceof t&&null!=e.ID&&(r=null!=(s=this.getExternalAttribute("connectionsOut"))?s:[],i=null!=(o=e.getExternalAttribute("connectionsIn"))?o:[],r.push([e.ID,n]),i.push([this.ID,n]),this.setExternalAttribute("connectionsOut",r),e.setExternalAttribute("connectionsIn",i),!0)},t.prototype.disconnectFrom=function(e,n){var i,r,s,o,l,u;if(!(null!=this.ID&&e instanceof t&&null!=e.ID))return!1;for(o=null!=(l=this.getExternalAttribute("connectionsOut"))?l:[],r=null!=(u=e.getExternalAttribute("connectionsIn"))?u:[],s=i=0;s<o.length&&(o[s][0]!==e.ID||o[s][1]!==n);)s++;if(s===o.length)return!1;for(;i<r.length&&(r[i][0]!==this.ID||r[i][1]!==n);)i++;return i!==r.length&&(o.splice(s,1),r.splice(i,1),this.setExternalAttribute("connectionsOut",o),e.setExternalAttribute("connectionsIn",r),!0)},t.prototype.allConnectionsOut=function(t){var e,n,i,r,s,o;if(r=null!=(s=this.getExternalAttribute("connectionsOut"))?s:[],null==t)return r;for(o=[],n=0,i=r.length;n<i;n++)(e=r[n])[1]===t&&o.push(e[0]);return o},t.prototype.allConnectionsIn=function(t){var e,n,i,r,s,o;if(n=null!=(s=this.getExternalAttribute("connectionsIn"))?s:[],null==t)return n;for(o=[],i=0,r=n.length;i<r;i++)(e=n[i])[1]===t&&o.push(e[0]);return o},t.prototype.allConnectionsTo=function(e){var n,i,r,s,o,l;if(!(e instanceof t&&null!=e.ID))return null;for(l=[],i=0,r=(s=null!=(o=this.getExternalAttribute("connectionsOut"))?o:[]).length;i<r;i++)(n=s[i])[0]===e.ID&&l.push(n[1]);return l},t.prototype.properties=function(){var e,n,i,r,s,o,l,u;for(l={},n=0,i=(o=null!=(s=this.getExternalAttribute("connectionsIn"))?s:[]).length;n<i;n++)e=o[n],null!=(u=t.instanceWithID(e[0]))&&(null!=l[r=e[1]]?l[r]:l[r]=[]).push(u);return l},t}();
//# sourceMappingURL=structure.js.map
