<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Module: GoogleDriveUtilities</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Module: GoogleDriveUtilities</h1>

    




<section>

<header>
    
</header>

<article>
    <div class="container-overview">
    
        
            <div class="description"><p>Functions for communicating with the Google Drive API.  This file abstracts
just the few key ways that Lurch wants to talk to a user's Google Drive, plus
the few Google-owned popup windows that may need to be presented, and exposes
them in a small API that makes it easier than making raw gapi calls.</p>
<p>The app will not import this module directly, but will instead import the
<a href="module-GoogleDriveUI.html">Google Drive UI module</a>, which uses this one
under the hood.</p></div>
        

        


<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="google-drive-utilities.js.html">google-drive-utilities.js</a>, <a href="google-drive-utilities.js.html#line2">line 2</a>
    </li></ul></dd>
    

    

    

    
</dl>


        
    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id=".ensureLoggedIn"><span class="type-signature">(static) </span>ensureLoggedIn<span class="signature">()</span><span class="type-signature"> &rarr; {Promise}</span></h4>
    

    



<div class="description">
    <p>Ensure the user has logged in by looking up their existing login information
if they've already logged in, or forcing them to log in so that we can get
their information thereafter.</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="google-drive-utilities.js.html">google-drive-utilities.js</a>, <a href="google-drive-utilities.js.html#line68">line 68</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>a promise that resolves with the user as parameter upon
success, or rejects if the user does not/cannot log in</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".listFilesFromFolder"><span class="type-signature">(static) </span>listFilesFromFolder<span class="signature">(folderId)</span><span class="type-signature"> &rarr; {Promise}</span></h4>
    

    



<div class="description">
    <p>This function retrieves a list of all files in a given Google Drive folder
that are of the MIME type used by this app (text/html).  The files may be
fetched in multiple pages, but this function fetches all necessary pages and
passes the concatenated files list to its promise resolution function.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>folderId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>the folder whose contents should be listed</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="google-drive-utilities.js.html">google-drive-utilities.js</a>, <a href="google-drive-utilities.js.html#line187">line 187</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>a promise that resolves when the full list of files has
been fetched, passing the array of filenames to the resolve function, or
rejects if an error occurs during the reading process</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".readFileFromDrive"><span class="type-signature">(static) </span>readFileFromDrive<span class="signature">(fileId)</span><span class="type-signature"> &rarr; {Promise}</span></h4>
    

    



<div class="description">
    <p>Read a file from the current user's Google Drive.  The client must pass a
file ID, which can be obtained by allowing the user to select a file from
their drive, using a function such as
<a href="module-GoogleDriveUtilities.html#.showOpenFilePicker">showOpenFilePicker()</a>.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>fileId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>a file ID from Google Drive</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="google-drive-utilities.js.html">google-drive-utilities.js</a>, <a href="google-drive-utilities.js.html#line96">line 96</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>a promise that resolves if the file can be read, passing a
response object whose <code>body</code> field contains the file's contents, or that
rejects if the file cannot be read</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".showOpenFilePicker"><span class="type-signature">(static) </span>showOpenFilePicker<span class="signature">()</span><span class="type-signature"> &rarr; {Promise}</span></h4>
    

    



<div class="description">
    <p>Show the user a file picker designed by Google, showing all text/html files
in their Google Drive.  The user may navigate among folders to choose files.
If they select one, the resulting promise resolves with that file's ID.</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="google-drive-utilities.js.html">google-drive-utilities.js</a>, <a href="google-drive-utilities.js.html#line212">line 212</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>a promise that resolves with the selected file ID if the
user chooses one, or never resolves if they cancel</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".showSaveFolderPicker"><span class="type-signature">(static) </span>showSaveFolderPicker<span class="signature">()</span><span class="type-signature"> &rarr; {Promise}</span></h4>
    

    



<div class="description">
    <p>Show the user a folder picker designed by Google, allowing the user to pick
a folder (other than the root folder) from their Google Drive.</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="google-drive-utilities.js.html">google-drive-utilities.js</a>, <a href="google-drive-utilities.js.html#line245">line 245</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>a promise that resolves with the selected folder ID if the
user chooses one, or never resolves if they cancel</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".updateFileInDrive"><span class="type-signature">(static) </span>updateFileInDrive<span class="signature">(filename, folderId, content)</span><span class="type-signature"> &rarr; {Promise}</span></h4>
    

    



<div class="description">
    <p>Update an existing file in the user's Google Drive by replacing its old
content with new content.  The client must pass a file ID plus the new
content to put into the file.  To get a file ID, use a function such as
<a href="module-GoogleDriveUtilities.html#.showOpenFilePicker">showOpenFilePicker()</a>.</p>
<p>If you want to create a new file, use
<a href="module-GoogleDriveUtilities.html#.writeNewFileToDrive">writeNewFileToDrive()</a>
instead.</p>
<p>This function always creates files with MIME type text/html, because that is
the MIME type we are currently using for files created by the Lurch app.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>filename</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>the name of the new file to create</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>folderId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>a folder ID from Google Drive</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>content</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>the data to write into the new file</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="google-drive-utilities.js.html">google-drive-utilities.js</a>, <a href="google-drive-utilities.js.html#line164">line 164</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>a promise that resolves once the file is created, or
rejects with an error message if the write attempt fails</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".writeNewFileToDrive"><span class="type-signature">(static) </span>writeNewFileToDrive<span class="signature">(filename, folderId, content)</span><span class="type-signature"> &rarr; {Promise}</span></h4>
    

    



<div class="description">
    <p>Write a new file to the current user's Google Drive.  The client must pass a
filename and folder ID, along with the content they want in the file.  Note
that in Google Drive, unlike many filesystems, you can have multiple files
with the same name in the same folder, so this function always creates a new
file.  To get a folder ID, use a function such as
<a href="module-GoogleDriveUtilities.html#.showSaveFolderPicker">showSaveFolderPicker()</a></p>
<p>If you want to update/overwrite an existing file, use
<a href="module-GoogleDriveUtilities.html#.updateFileInDrive">updateFileInDrive()</a>
instead.</p>
<p>This function always creates files with MIME type text/html, because that is
the MIME type we are currently using for files created by the Lurch app.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>filename</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>the name of the new file to create</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>folderId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>a folder ID from Google Drive</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>content</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>the data to write into the new file</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="google-drive-utilities.js.html">google-drive-utilities.js</a>, <a href="google-drive-utilities.js.html#line123">line 123</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>a promise that resolves once the file is created, or
rejects with an error message if the write attempt fails</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~currentUser"><span class="type-signature">(inner) </span>currentUser<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Just a shortcut to simplify multiple pieces of code later that need to get
the current user from a chain of Google API calls.</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="google-drive-utilities.js.html">google-drive-utilities.js</a>, <a href="google-drive-utilities.js.html#line57">line 57</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-GoogleDriveUI.html">GoogleDriveUI</a></li><li><a href="module-GoogleDriveUtilities.html">GoogleDriveUtilities</a></li><li><a href="module-SettingsInstaller.html">SettingsInstaller</a></li><li><a href="module-Utilities.html">Utilities</a></li></ul><h3>Classes</h3><ul><li><a href="BoolSettingMetadata.html">BoolSettingMetadata</a></li><li><a href="CategorySettingMetadata.html">CategorySettingMetadata</a></li><li><a href="ColorSettingMetadata.html">ColorSettingMetadata</a></li><li><a href="LurchDocument.html">LurchDocument</a></li><li><a href="NoteMetadata.html">NoteMetadata</a></li><li><a href="SettingMetadata.html">SettingMetadata</a></li><li><a href="Settings.html">Settings</a></li><li><a href="SettingsCategoryMetadata.html">SettingsCategoryMetadata</a></li><li><a href="SettingsMetadata.html">SettingsMetadata</a></li><li><a href="TextSettingMetadata.html">TextSettingMetadata</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>